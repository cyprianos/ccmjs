#! /usr/bin/env node

var ccm = require('../ccm.js');
var fs = require('fs');
var util = require('util');
var glob = require('glob');
var argv = require('optimist')
            .default('files', './**/*.js')
            .default('encoding', 'utf8')
            .argv;

            
glob(argv.files, function(err, files) {

  files.forEach(function(file) {
    console.log('ccm for ' + file);

    try {
      var fileContent = fs.readFileSync(file, { encoding: argv.encoding });
      var res = ccm.calculate( fileContent );
      console.log(util.inspect(res));
    } catch(err) {
      console.log(util.inspect(err));
    }
  });
});


